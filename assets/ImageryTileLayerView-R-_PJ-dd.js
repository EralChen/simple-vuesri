import{E as r,F as i,d5 as j,H as P,e1 as x,e4 as V,s as T,dh as F,t as L}from"./index--fOyh5XL.js";const _=b=>{let e=class extends b{constructor(){super(...arguments),this._rasterFieldPrefix="Raster.",this.layer=null,this.view=null,this.tileInfo=null}get fullExtent(){return this._getfullExtent()}_getfullExtent(){return x(this.layer.rasterInfo,this.view.spatialReference)}get hasTilingEffects(){return!!(this.layer.renderer&&"dynamicRangeAdjustment"in this.layer.renderer&&this.layer.renderer.dynamicRangeAdjustment)}get datumTransformation(){return V(this.layer.fullExtent,this.view.spatialReference,!0)}supportsSpatialReference(o){return!!x(this.layer.rasterInfo,o)}async fetchPopupFeatures(o,R){const{layer:t}=this;if(!o)throw new T("imageryTileLayerView:fetchPopupFeatures","Nothing to fetch without area",{layer:t});const{popupEnabled:c}=t,h=F(t,R);if(!c||h==null)throw new T("imageryTileLayerView:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",{popupEnabled:c,popupTemplate:h});const m=[],{value:l,magdirValue:n,processedValue:d}=await t.identify(o,{timeExtent:this.timeExtent});let u="";if(l&&l.length){u=t.type==="imagery-tile"&&t.hasStandardTime()&&l[0]!=null?l.map(y=>t.getStandardTimeValue(y)).join(", "):l.join(", ");const s={ObjectId:0},g="Raster.ServicePixelValue";s[g]=(d==null?void 0:d.join(", "))??u,s[g+".Raw"]=u;const w=t.rasterInfo.attributeTable;if(w!=null){const{fields:y,features:I}=w,E=y.find(({name:a})=>a.toLowerCase()==="value"),f=E?I.find(a=>String(a.attributes[E.name])===u):null;if(f)for(const a in f.attributes)f.attributes.hasOwnProperty(a)&&(s[this._rasterFieldPrefix+a]=f.attributes[a])}const v=t.rasterInfo.dataType;v!=="vector-magdir"&&v!=="vector-uv"||(s["Raster.Magnitude"]=n==null?void 0:n[0],s["Raster.Direction"]=n==null?void 0:n[1]);const p=new L(this.fullExtent.clone(),null,s);p.layer=t,p.sourceLayer=p.layer,m.push(p)}return m}};return r([i()],e.prototype,"layer",void 0),r([i(j)],e.prototype,"timeExtent",void 0),r([i()],e.prototype,"view",void 0),r([i()],e.prototype,"fullExtent",null),r([i()],e.prototype,"tileInfo",void 0),r([i({readOnly:!0})],e.prototype,"hasTilingEffects",null),r([i()],e.prototype,"datumTransformation",null),e=r([P("esri.views.layers.ImageryTileLayerView")],e),e};export{_ as p};

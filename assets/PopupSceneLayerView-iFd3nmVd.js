import{E as d,H as y,s as l,dh as h,d8 as f,di as w,dK as F}from"./index--fOyh5XL.js";const x=o=>{let r=class extends o{_validateFetchPopupFeatures(p){const{layer:e}=this,{popupEnabled:t}=e;if(!t)throw new l("scenelayerview3d:fetchPopupFeatures","Popups are disabled",{layer:e});if(!h(e,p))throw new l("scenelayerview3d:fetchPopupFeatures","Layer does not define a popup template",{layer:e})}async prepareFetchPopupFeatures(p){}async fetchPopupFeatures(p,e){this._validateFetchPopupFeatures(e);const t=e!=null?e.clientGraphics:null;if(!t||t.length===0)return[];const u=this.layer.type==="scene"&&this.layer.associatedLayer!=null?this.layer.associatedLayer:this.layer;let i=[];"fieldsIndex"in this.layer&&(i=f(this.layer.fieldsIndex,await w(u,h(this.layer,e)))),await this.prepareFetchPopupFeatures(i);const c=new Set,n=[],a=[];for(const s of t)F(i,s,c)?a.push(s):n.push(s);return a.length===0?n:this.whenGraphicAttributes(a,[...c]).catch(()=>a).then(s=>n.concat(s))}};return r=d([y("esri.views.3d.layers.support.PopupSceneLayerView")],r),r};export{x as i};
